# Виртуальные окружения Python

## Что такое виртуальное окружение

Виртуальное окружение (virtual environment) — это изолированная среда Python, которая позволяет устанавливать пакеты независимо от системной установки Python и других проектов. Каждое окружение имеет свой собственный набор пакетов.

## Зачем нужны виртуальные окружения

1. **Изоляция зависимостей** — разные проекты могут использовать разные версии одного пакета
2. **Чистота системы** — не засоряете системный Python
3. **Воспроизводимость** — легко передать проект другому разработчику
4. **Тестирование** — можно проверить работу с разными версиями пакетов

## Создание и использование venv

### Встроенный модуль venv (рекомендуется)

```bash
# Создание виртуального окружения
python -m venv venv

# Активация (Windows)
venv\Scripts\activate

# Активация (Linux/macOS)
source venv/bin/activate

# Деактивация
deactivate
```

### Проверка активации

После активации в командной строке появится префикс `(venv)`, а команда `which python` (или `where python` на Windows) покажет путь внутри папки venv.

## Управление зависимостями

### Установка пакетов

```bash
pip install package_name              # Установить пакет
pip install package==1.2.3            # Определённая версия
pip install package>=1.2.0            # Минимальная версия
pip install -r requirements.txt       # Из файла зависимостей
```

### Экспорт зависимостей

```bash
pip freeze > requirements.txt         # Все установленные пакеты
pip list                              # Показать установленные пакеты
pip show package_name                 # Информация о пакете
```

## Формат requirements.txt

```text
fastapi==0.109.0
uvicorn>=0.27.0
pydantic>=2.0,<3.0
python-dotenv~=1.0.0
```

Операторы версий:

- `==` — точная версия
- `>=` — минимальная версия
- `<=` — максимальная версия
- `~=` — совместимая версия (1.0.0 включает 1.0.x, но не 1.1.0)

## Альтернативы venv

### Poetry

```bash
poetry new project          # Создать проект
poetry add package          # Добавить зависимость
poetry install              # Установить зависимости
poetry shell                # Активировать окружение
```

### Conda

```bash
conda create -n myenv python=3.11
conda activate myenv
conda install package
```

## Частые вопросы

**Нужно ли добавлять venv в git?**
Нет, папку `venv/` следует добавить в `.gitignore`. В репозиторий добавляется только `requirements.txt`.

**Как обновить все пакеты?**

```bash
pip install --upgrade -r requirements.txt
# или отдельный пакет
pip install --upgrade package_name
```

**Как удалить виртуальное окружение?**
Просто удалите папку `venv/`. Это безопасно, так как окружение полностью изолировано.

**Как узнать версию Python в окружении?**

```bash
python --version
```
