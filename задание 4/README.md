# gRPC Glossary Service

Сервис глоссария терминов, реализованный с использованием gRPC и Protocol Buffers на Node.js.

## Описание проекта

### Цель

Реализация REST-подобного API для управления глоссарием терминов с использованием технологии gRPC вместо традиционного REST API.

### Архитектура

```
┌─────────────┐     gRPC/Protobuf     ┌─────────────┐
│             │ ◄──────────────────── │             │
│   Client    │                       │   Server    │
│  (client.js)│ ────────────────────► │ (server.js) │
└─────────────┘                       └──────┬──────┘
                                             │
                                             ▼
                                      ┌─────────────┐
                                      │   SQLite    │
                                      │ (glossary.db)│
                                      └─────────────┘
```

### Технологии

- **Node.js** — среда выполнения
- **gRPC** — фреймворк для удаленного вызова процедур
- **Protocol Buffers** — бинарный формат сериализации
- **SQLite** — легковесная база данных
- **Docker** — контейнеризация

## Структура проекта

```
задание 4/
├── proto/
│   └── glossary.proto       # Определение сервиса и сообщений
├── src/
│   ├── server.js            # gRPC сервер
│   ├── client.js            # Демонстрационный клиент
│   └── db.js                # Работа с SQLite
├── Dockerfile               # Docker-образ
├── docker-compose.yml       # Docker Compose конфигурация
├── package.json             # Зависимости Node.js
├── README.md                # Документация
└── RESEARCH.md              # Исследование REST vs RPC vs GraphQL
```

## Proto-файл

Сервис определен в `proto/glossary.proto`:

### Сообщения (Messages)

| Message             | Описание                                                                   |
| ------------------- | -------------------------------------------------------------------------- |
| `Empty`             | Пустое сообщение                                                           |
| `Term`              | Полная информация о термине (id, term, definition, created_at, updated_at) |
| `TermList`          | Список терминов                                                            |
| `TermRequest`       | Запрос по ключевому слову                                                  |
| `CreateTermRequest` | Данные для создания термина                                                |
| `UpdateTermRequest` | Данные для обновления термина                                              |
| `OperationResult`   | Результат операции (success, message)                                      |

### Методы сервиса (GlossaryService)

| Метод        | Запрос            | Ответ           | Описание                 |
| ------------ | ----------------- | --------------- | ------------------------ |
| `GetTerms`   | Empty             | TermList        | Получить все термины     |
| `GetTerm`    | TermRequest       | Term            | Получить термин по ключу |
| `CreateTerm` | CreateTermRequest | Term            | Создать термин           |
| `UpdateTerm` | UpdateTermRequest | Term            | Обновить термин          |
| `DeleteTerm` | TermRequest       | OperationResult | Удалить термин           |

## Инструкция по запуску

### Локальный запуск

1. **Установка зависимостей:**

   ```bash
   cd "задание 4"
   npm install
   ```

2. **Запуск сервера:**

   ```bash
   npm start
   ```

   Сервер запустится на `localhost:50051`

3. **Запуск клиента (в другом терминале):**

   ```bash
   npm run client
   ```

### Запуск через Docker

1. **Сборка и запуск:**

   ```bash
   docker-compose up --build
   ```

2. **Или через Docker напрямую:**

   ```bash
   docker build -t glossary-grpc .
   docker run -p 50051:50051 glossary-grpc
   ```

## Примеры использования

### Запуск демонстрации

```bash
# Терминал 1 - Сервер
npm start

# Терминал 2 - Клиент
npm run client
```

### Вывод клиента

```
============================================================
gRPC Glossary Client - Демонстрация
============================================================

1. Создание терминов...
----------------------------------------
✓ Создан: gRPC
✓ Создан: Protobuf
✓ Создан: HTTP/2
✓ Создан: RPC

2. Получение всех терминов...
----------------------------------------
Найдено терминов: 4

  ID: 4
  Термин: RPC
  Определение: Remote Procedure Call - удаленный вызов процедур
  ...

3. Получение термина "gRPC"...
----------------------------------------
  ID: 1
  Термин: gRPC
  Определение: Google Remote Procedure Call - фреймворк для удаленного вызова процедур
  ...

4. Обновление термина "gRPC"...
----------------------------------------
✓ Термин обновлен

5. Попытка получить несуществующий термин...
----------------------------------------
✓ Ожидаемая ошибка: Термин 'НесуществующийТермин' не найден

6. Удаление термина "RPC"...
----------------------------------------
✓ Термин 'RPC' успешно удален

============================================================
Демонстрация завершена
============================================================
```

## Сравнение с REST API (задание 3)

| Аспект                  | REST (задание 3)      | gRPC (задание 4)         |
| ----------------------- | --------------------- | ------------------------ |
| **Протокол**            | HTTP/1.1              | HTTP/2                   |
| **Формат данных**       | JSON (текст)          | Protobuf (бинарный)      |
| **Схема данных**        | OpenAPI (опционально) | Proto-файл (обязательно) |
| **Типизация**           | Слабая                | Строгая                  |
| **Документация**        | Swagger UI            | Proto-файл               |
| **Производительность**  | Медленнее             | Быстрее                  |
| **Размер сообщений**    | Больше                | Меньше (до 10x)          |
| **Поддержка браузеров** | Нативная              | Требует gRPC-Web         |
| **Streaming**           | Ограниченный          | Полная поддержка         |

### Преимущества gRPC для данной задачи

1. **Строгая типизация** - ошибки выявляются на этапе компиляции
2. **Компактные сообщения** - бинарный формат экономит трафик
3. **Автогенерация кода** - клиенты и серверы генерируются из proto-файла
4. **HTTP/2** - мультиплексирование, сжатие заголовков
5. **Streaming** - поддержка потоковой передачи данных

### Когда использовать gRPC

- Микросервисная архитектура
- Высоконагруженные системы
- Межсервисное взаимодействие
- Когда важна производительность

### Когда использовать REST

- Публичные API
- Интеграция с браузерами
- Простые CRUD-операции
- Когда важна простота интеграции

## Обработка ошибок

Сервер возвращает стандартные gRPC статус-коды:

| Код | Константа        | Описание              |
| --- | ---------------- | --------------------- |
| 0   | OK               | Успешно               |
| 3   | INVALID_ARGUMENT | Неверные параметры    |
| 5   | NOT_FOUND        | Термин не найден      |
| 6   | ALREADY_EXISTS   | Термин уже существует |
| 13  | INTERNAL         | Внутренняя ошибка     |

## Лицензия

MIT License
